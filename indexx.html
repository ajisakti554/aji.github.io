<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset='UTF-8' />
    <meta content='width=device-width, initial-scale=1, user-scalable=1, minimum-scale=1, maximum-scale=5' name='viewport' />
    <meta content='IE=edge' http-equiv='X-UA-Compatible' />
    <title>üíå Surat Spesial untuk Kamu üíå</title>
    
    <!-- Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.all.min.js"></script>
    <script src="https://unpkg.com/typeit@8.7.0/dist/index.umd.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js" defer></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { width: 100%; height: 100%; overflow: hidden; font-family: 'Poppins', sans-serif; background: linear-gradient(135deg, #ffd6e7 0%, #ffeff6 100%); color: #2c3e50; }
        
        /* Loading Screen */
        .overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, #ff6b9d, #e84393);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 9999; transition: opacity 0.5s ease;
        }
        .loading-message { color: white; font-size: 20px; text-align: center; margin-bottom: 20px; animation: pulse 1.5s infinite; }
        .blocklove { width: 80px; height: 80px; background: rgba(255, 255, 255, 0.2); border-radius: 50%; display: flex; justify-content: center; align-items: center; color: white; font-size: 30px; animation: rotate 2s linear infinite; }
        .progress-container { width: 80%; max-width: 300px; height: 4px; background: rgba(255, 255, 255, 0.3); border-radius: 2px; margin-top: 20px; overflow: hidden; }
        .progress-bar { height: 100%; width: 0%; background: white; border-radius: 2px; transition: width 0.3s ease; }
        
        /* Main Content */
        .main-content { display: none; opacity: 0; transition: opacity 0.5s ease; width: 100%; height: 100vh; position: fixed; top: 0; left: 0; overflow: hidden; }
        
        /* Background */
        #bodyblur { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2; overflow: hidden; }
        #wallpaper { width: 100%; height: 100%; object-fit: cover; filter: brightness(0.9) sepia(0.2) hue-rotate(320deg) saturate(1.3); }
        
        /* Swiper */
        .swiper-container { width: 100%; height: 100vh; position: relative; }
        .swiper { width: 100%; height: 100%; position: absolute; top: 0; left: 0; }
        .swiper-wrapper { height: 100%; }
        .swiper-slide { display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 20px; text-align: center; width: 100%; height: 100%; overflow: hidden; }
        .swiper-pagination { display: none !important; }
        
        /* Slide Content */
        .slide-content { max-width: 500px; width: 90%; max-height: 85vh; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
        
        /* Stiker */
        .stiker { margin: 15px 0; animation: float 3.5s ease-in-out infinite; flex-shrink: 0; }
        .stiker img { width: 120px; height: 120px; border-radius: 20px; object-fit: cover; border: 3px solid #ffb6c1; box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        
        /* Game */
        .game-container { width: 100%; max-width: 400px; margin: 10px 0; padding: 15px; background: linear-gradient(135deg, rgba(255, 182, 193, 0.15), rgba(255, 105, 180, 0.08)); border-radius: 20px; border: 2px solid rgba(255, 182, 193, 0.3); box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        .game-board { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin: 15px 0; perspective: 1000px; justify-content: center; }
        .card { width: 65px; height: 65px; background: linear-gradient(135deg, #ff6b9d, #e84393); border-radius: 10px; display: flex; justify-content: center; align-items: center; font-size: 24px; cursor: pointer; transform-style: preserve-3d; transition: transform 0.5s; user-select: none; box-shadow: 0 4px 8px rgba(0,0,0,0.1); color: white; }
        .card.flipped { transform: rotateY(180deg); }
        .card.matched { background: linear-gradient(135deg, #9b59b6, #8e44ad); cursor: default; }
        
        /* Typography */
        .slide-title { color: #8e44ad; margin: 10px 0; font-family: 'Dancing Script', cursive; font-size: 2rem; text-shadow: 1px 1px 3px rgba(0,0,0,0.1); line-height: 1.3; font-weight: 700; }
        .special-title { color: #8e44ad; margin: 15px 0; font-family: 'Dancing Script', cursive; font-size: 2.2rem; text-shadow: 1px 1px 3px rgba(0,0,0,0.1); font-weight: 700; }
        .slide-text { font-family: 'Poppins', sans-serif; line-height: 1.6; margin: 10px 0; color: #2c3e50; font-size: 1.05rem; font-weight: 400; }
        .message-container {
            width: 100%;
            max-width: 500px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            border: 1px solid rgba(255, 182, 193, 0.4);
            margin: 10px 0;
            max-height: 70vh; /* Gunakan viewport height */
            overflow-y: auto; /* Biarkan discroll jika konten panjang */
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            min-height: 100px;
        }
        /* Tambahkan scrollbar yang lebih cantik */
        .message-container::-webkit-scrollbar {
            width: 6px;
        }
        .message-container::-webkit-scrollbar-track {
            background: rgba(255, 182, 193, 0.1);
            border-radius: 10px;
        }
        .message-container::-webkit-scrollbar-thumb {
            background: rgba(255, 107, 157, 0.5);
            border-radius: 10px;
        }
        .message-container::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 107, 157, 0.8);
        }
        .message-text { 
            font-family: 'Poppins', sans-serif; 
            line-height: 1.7; 
            margin: 10px 0; 
            color: #2c3e50; 
            font-size: 1.05rem; 
            font-weight: 400; 
            min-height: 60px;
        }
        .typing-cursor {
            display: inline-block;
            width: 3px;
            height: 1.2em;
            background-color: #e84393;
            margin-left: 2px;
            animation: blink 1s infinite;
            vertical-align: middle;
        }
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
        .highlight-name { color: #e84393; font-weight: 700; font-size: 1.1em; }
        .romantic-text { color: #e84393; font-family: 'Dancing Script', cursive; font-size: 1.4em; font-weight: 700; text-shadow: 1px 1px 2px rgba(0,0,0,0.1); }
        
        /* Buttons */
        .btn-start, .btn-reset, .btn-response { 
            background: linear-gradient(135deg, #ff6b9d, #e84393); 
            color: white; 
            border: none; 
            padding: 14px 30px; 
            border-radius: 50px; 
            font-size: 16px; 
            font-weight: 600; 
            cursor: pointer; 
            margin: 12px; 
            transition: all 0.3s ease; 
            box-shadow: 0 6px 15px rgba(155, 89, 182, 0.3); 
            font-family: 'Poppins', sans-serif; 
            flex-shrink: 0; 
            letter-spacing: 0.5px; 
        }
        .btn-start:hover, .btn-reset:hover, .btn-response:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(155, 89, 182, 0.4); }
        
        /* Game Status */
        .game-status { margin: 12px 0; color: #8e44ad; font-weight: 600; font-family: 'Poppins', sans-serif; font-size: 0.95rem; }
        .instructions { 
            margin-top: 15px; 
            font-size: 14px; 
            color: #7f8c8d; 
            font-family: 'Poppins', sans-serif; 
            font-style: italic; 
            padding: 8px 15px; 
            background: rgba(255, 255, 255, 0.7); 
            border-radius: 10px; 
            border: 1px dashed #ffb6c1; 
            min-height: 40px;
        }
        
        /* Navigation Controls */
        .nav-controls { position: fixed; bottom: 20px; left: 0; width: 100%; display: flex; justify-content: center; gap: 15px; z-index: 100; opacity: 0; transition: opacity 0.5s; }
        .nav-btn { background: linear-gradient(135deg, #ff6b9d, #e84393); color: white; border: none; width: 45px; height: 45px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.2); transition: all 0.3s; }
        .nav-btn:hover { transform: scale(1.1); box-shadow: 0 6px 15px rgba(0,0,0,0.3); }
        .nav-btn:disabled { opacity: 0.4; cursor: not-allowed; transform: none !important; }
        
        /* Final Slide */
        .final-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
            width: 100%;
        }
        
        .final-message {
            font-family: 'Dancing Script', cursive;
            font-size: 1.8rem;
            color: #e84393;
            margin: 20px 0;
            line-height: 1.4;
        }
        
        footer { 
            margin-top: 25px; 
            font-size: 14px; 
            color: #8e44ad; 
            opacity: 0.8; 
            font-family: 'Poppins', sans-serif; 
            font-weight: 500; 
            text-align: center;
            padding: 15px;
            width: 100%;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            border: 1px dashed #ffb6c1;
        }
        
        /* Animations */
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        @keyframes rotate { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes float { 0%, 100% { transform: translateY(0) rotate(0); } 50% { transform: translateY(-10px) rotate(2deg); } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in { animation: fadeIn 0.5s ease forwards; }
        
        /* Responsive */
        @media (max-width: 600px) {
            .card { width: 55px; height: 55px; font-size: 20px; }
            .slide-title { font-size: 1.7rem; }
            .special-title { font-size: 1.8rem; }
            .message-container { 
                max-height: 60vh; /* Lebih kecil di mobile */
                padding: 12px; 
            }
            .stiker img { width: 100px; height: 100px; }
            .btn-start, .btn-reset, .btn-response { 
                padding: 12px 25px; 
                font-size: 15px; 
            }
            .slide-text, .message-text { font-size: 1rem; }
            .final-message { font-size: 1.5rem; }
        }
        @media (max-height: 700px) {
            .stiker img { width: 90px; height: 90px; }
            .slide-title { font-size: 1.5rem; margin: 8px 0; }
            .message-container { 
                max-height: 55vh; /* Lebih kecil di perangkat dengan tinggi kecil */
                padding: 10px; 
            }
            .card { width: 50px; height: 50px; font-size: 18px; }
            .final-message { font-size: 1.3rem; }
        }
    </style>
</head>

<body>
    <!-- Audio -->
    <audio src="https://feeldreams.github.io/audio/foreveryoung.mp3" id="linkmp3" preload="auto"></audio>
    
    <!-- Overlay Loading -->
    <div class="overlay" id="overlay">
        <div class="loading-message">Preparing a surprise for you... üíñ</div>
        <div class="blocklove">üíù</div>
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
    </div>
    
    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <!-- Background -->
        <div id="bodyblur">
            <img src="https://images.unsplash.com/photo-1519378058457-4c29a0a2efac?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&q=80" 
                 id="wallpaper" 
                 loading="eager"
                 style="opacity:0;transition:opacity 0.5s" 
                 onload="this.style.opacity=1" />
        </div>
        
        <!-- Navigation Controls -->
        <div class="nav-controls" id="navControls">
            <button class="nav-btn" id="prevBtn" onclick="prevSlide()" disabled>‚óÄ</button>
            <button class="nav-btn" id="nextBtn" onclick="nextSlide()" disabled>‚ñ∂</button>
        </div>
        
        <!-- Swiper Container -->
        <div class="swiper-container">
            <div class="swiper mySwiper">
                <div class="swiper-wrapper">
                    <!-- Slides akan dibuat secara dinamis oleh JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- ============================================== -->
    <!-- BAGIAN 1: KONFIGURASI KONTEN (EDIT DISINI) -->
    <!-- ============================================== -->
    <script id="content-config">
        // ========== KONFIGURASI UMUM ==========
        const CONFIG = {
            // Nama default jika user tidak input nama
            defaultName: "Kamu",
            
            // URL musik (bisa diganti)
            musicUrl: "https://feeldreams.github.io/audio/foreveryoung.mp3",
            
            // Background wallpaper (bisa diganti)
            backgroundUrl: "https://images.unsplash.com/photo-1519378058457-4c29a0a2efac?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&q=80",
            
            // Warna utama
            colors: {
                primary: "#ff6b9d",
                secondary: "#e84393",
                dark: "#2c3e50"
            }
        };
        
        // ========== SLIDES CONTENT (EDIT PESAN DISINI) ==========
        const SLIDES = [
            {
                id: 1,
                type: "intro",
                title: "Hai! üëã",
                text: "There's something special for you...",
                image: "https://feeldreams.github.io/pusn.gif",
                buttonText: "open üíå",
                instruction: "Klik tombol di atas untuk memulai"
            },
            {
                id: 2,
                type: "message",
                title: "I Have Something<br>For Youuu! üòù",
                text: "santai aja yaa, jan terlalu seriuss. main game dulu aja deh...",
                image: "https://feeldreams.github.io/weee.gif",
                instruction: "Tunggu sebentar ya..."
            },
            {
                id: 3,
                type: "game",
                title: "Coba Selesaikan<br><i>Memory Game</i> ini! üòÜ",
                text: "Temukan semua pasangan emoji!",
                instruction: "Selesaikan game untuk melanjutkan"
            },
            {
                id: 4,
                type: "message",
                title: "ü•≥ Special Message ü•≥",
                text: "Boring kan game nya HAHAHA, setidaknya berusaha cairin suasana ya kannn. plis bilang terhibur, ribet lo bikin nya wkwk ",
                image: "https://feeldreams.github.io/emawh.gif",
                instruction: "Pesan sedang ditulis..."
            },
            {
                id: 5,
                type: "final",
                title: "ü•≥ Special Message ü•≥",
                text: "I just want to say what I feel, I know the consequences and I'm ready. So stop apologizing and thinking as if you pity me. I'm a man, I can solve my own problems. So please don't say things like that again, focus on yourself and your boyfriend. If you still think like that, I'm disappointed. Thank you for everything Naila, I respect your boyfriend, I promise not to bother you anymore and I will move on as soon as possible. Keep my words.üëã",
                instruction: "Ini adalah pesan terakhir..."
            }
        ];
        
        // ========== GAME EMOJI ==========
        const GAME_EMOJIS = ['ü´∂', '‚ù§Ô∏è', 'ü•≥', 'ü´£', 'ü§ç', 'üòç', 'ü•∞', 'ü©∑'];
    </script>

    <!-- ============================================== -->
    <!-- BAGIAN 2: JAVASCRIPT (JANGAN EDIT BAGIAN INI) -->
    <!-- ============================================== -->
    <script>
        // Inisialisasi variabel global
        let audio;
        let swiper;
        let namaGebetan = "";
        
        // State untuk kontrol slide
        let currentSlide = 0;
        let slideStates = [];
        
        // Game variables
        let gameCards = [];
        let flippedCards = [];
        let matchedPairs = 0;
        let canFlip = true;
        
        // Untuk mengatur efek typing
        let typingIntervals = {};
        
        // Inisialisasi slide states
        function initSlideStates() {
            slideStates = SLIDES.map(() => ({ completed: false, autoComplete: false, typed: false }));
        }
        
        // Loading progress
        document.addEventListener('DOMContentLoaded', function() {
            let progress = 0;
            const progressBar = document.getElementById('progressBar');
            const overlay = document.getElementById('overlay');
            const mainContent = document.getElementById('mainContent');
            
            const progressInterval = setInterval(() => {
                progress += Math.random() * 10 + 3; // Diperlambat
                if (progress > 100) progress = 100;
                progressBar.style.width = progress + '%';
                
                if (progress >= 100) {
                    clearInterval(progressInterval);
                    
                    setTimeout(() => {
                        overlay.style.opacity = '0';
                        setTimeout(() => {
                            overlay.style.display = 'none';
                            mainContent.style.display = 'block';
                            setTimeout(() => {
                                mainContent.style.opacity = '1';
                                initApp();
                            }, 50);
                        }, 800); // Diperlambat
                    }, 500); // Diperlambat
                }
            }, 150); // Diperlambat
        });
        
        // Inisialisasi aplikasi
        function initApp() {
            // Setup slide states
            initSlideStates();
            
            // Setup Swiper dengan KONTROL PENUH
            swiper = new Swiper('.mySwiper', {
                direction: 'horizontal',
                slidesPerView: 1,
                spaceBetween: 0,
                mousewheel: false,
                touchRatio: 0,
                keyboard: false,
                simulateTouch: false,
                allowTouchMove: false,
                pagination: { el: '.swiper-pagination', clickable: false },
                navigation: false,
                speed: 600, // Diperlambat dari 400ms
                on: {
                    init: function() {
                        createSlides();
                    },
                    slideChange: function() {
                        currentSlide = this.activeIndex;
                        updateNavigationControls();
                        handleSlideChange(currentSlide);
                    }
                }
            });
            
            updateNavigationControls();
        }
        
        // Buat slides berdasarkan konfigurasi
        function createSlides() {
            const swiperWrapper = document.querySelector('.swiper-wrapper');
            swiperWrapper.innerHTML = '';
            
            SLIDES.forEach((slide, index) => {
                const slideElement = document.createElement('div');
                slideElement.className = 'swiper-slide';
                
                let slideContent = '';
                
                switch(slide.type) {
                    case 'intro':
                        slideContent = `
                            <div class="slide-content">
                                <div class="stiker fade-in">
                                    <img src="${slide.image}" loading="lazy" style="opacity:0;transition:opacity 0.5s" onload="this.style.opacity=1" />
                                </div>
                                <h1 class="slide-title fade-in" id="greetingTitle">${slide.title}</h1>
                                <div class="message-container fade-in">
                                    <p class="slide-text">${slide.text}</p>
                                </div>
                                <button class="btn-start fade-in" onclick="mulaiPengalaman()" id="startBtn">
                                    ${slide.buttonText}
                                </button>
                                <div class="instructions fade-in">
                                    ${slide.instruction}
                                </div>
                            </div>
                        `;
                        break;
                        
                    case 'game':
                        slideContent = `
                            <div class="slide-content">
                                <div class="game-container fade-in">
                                    <h1 class="slide-title">${slide.title}</h1>
                                    <div class="game-board" id="gameBoard"></div>
                                    <p id="gameStatus" class="game-status">
                                        ${slide.text}
                                    </p>
                                    <button class="btn-reset" onclick="resetGame()" id="resetBtn">
                                        Mulai Ulang Game üîÑ
                                    </button>
                                </div>
                                <div class="instructions fade-in" id="gameInstruction">
                                    ${slide.instruction}
                                </div>
                            </div>
                        `;
                        break;
                        
                    case 'final':
                        slideContent = `
                            <div class="slide-content final-content">
                                <h1 class="special-title fade-in">${slide.title}</h1>
                                <div class="message-container fade-in" style="max-height: 50vh;">
                                    <p id="message-${index}" class="message-text"></p>
                                </div>
                                <footer>Dibuat dengan sepenuh hati hanya untukmu ‚ù§Ô∏è</footer>
                            </div>
                        `;
                        break;
                        
                    default: // message
                        slideContent = `
                            <div class="slide-content">
                                ${slide.title.includes('Pesan Spesial') ? `<h1 class="special-title fade-in">${slide.title}</h1>` : `<h1 class="slide-title fade-in">${slide.title}</h1>`}
                                ${slide.image ? `
                                    <div class="stiker fade-in">
                                        <img src="${slide.image}" loading="lazy" style="opacity:0;transition:opacity 0.5s" onload="this.style.opacity=1" />
                                    </div>
                                ` : ''}
                                <div class="message-container fade-in">
                                    <p id="message-${index}" class="message-text"></p>
                                </div>
                                <div class="instructions fade-in" id="instruction-${index}">
                                    ${slide.instruction}
                                </div>
                            </div>
                        `;
                }
                
                slideElement.innerHTML = slideContent;
                slideElement.dataset.slideId = slide.id;
                swiperWrapper.appendChild(slideElement);
            });
            
            // Update background
            document.getElementById('wallpaper').src = CONFIG.backgroundUrl;
            
            // Update audio
            document.getElementById('linkmp3').src = CONFIG.musicUrl;
        }
        
        // Update navigation controls
        function updateNavigationControls() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const navControls = document.getElementById('navControls');
            
            if (slideStates[currentSlide]?.completed) {
                navControls.style.opacity = '1';
            } else {
                navControls.style.opacity = '0';
            }
            
            prevBtn.disabled = currentSlide === 0;
            // Untuk slide terakhir, tombol next dinonaktifkan
            nextBtn.disabled = !slideStates[currentSlide]?.completed || currentSlide === SLIDES.length - 1;
        }
        
        // Fungsi navigasi slide
        function nextSlide() {
            if (slideStates[currentSlide]?.completed && currentSlide < SLIDES.length - 1) {
                swiper.slideNext();
            }
        }
        
        function prevSlide() {
            if (currentSlide > 0) {
                swiper.slidePrev();
            }
        }
        
        // Mark slide as completed
        function completeSlide(slideIndex) {
            if (slideStates[slideIndex]) {
                slideStates[slideIndex].completed = true;
                updateNavigationControls();
                
                // Untuk slide terakhir, tidak ada auto navigate
                if (slideStates[slideIndex].autoComplete && slideIndex < SLIDES.length - 1) {
                    setTimeout(() => {
                        swiper.slideNext();
                    }, 2000); // Diperlambat dari 1000ms
                }
            }
        }
        
        // Fungsi untuk efek typing kata per kata (DIPERLAMBAT)
        function typeText(elementId, text, slideIndex, onComplete) {
            const element = document.getElementById(elementId);
            if (!element) return;
            
            // Hapus interval sebelumnya jika ada
            if (typingIntervals[elementId]) {
                clearInterval(typingIntervals[elementId]);
            }
            
            element.innerHTML = '';
            
            // Split text menjadi kata-kata
            const words = text.split(' ');
            let currentWordIndex = 0;
            let cursorVisible = true;
            
            // Tambahkan cursor
            const cursor = document.createElement('span');
            cursor.className = 'typing-cursor';
            element.appendChild(cursor);
            
            // Fungsi untuk mengetik kata berikutnya
            function typeNextWord() {
                if (currentWordIndex < words.length) {
                    // Hapus cursor sementara
                    cursor.style.display = 'none';
                    
                    // Tambahkan kata
                    if (currentWordIndex > 0) {
                        element.insertBefore(document.createTextNode(' '), cursor);
                    }
                    element.insertBefore(document.createTextNode(words[currentWordIndex]), cursor);
                    
                    // Tampilkan kembali cursor
                    cursor.style.display = 'inline-block';
                    
                    currentWordIndex++;
                    
                    // Scroll ke bawah jika perlu
                    element.parentElement.scrollTop = element.parentElement.scrollHeight;
                    
                    // Atur kecepatan berdasarkan panjang kata (DIPERLAMBAT)
                    const word = words[currentWordIndex - 1];
                    // Delay antara 120ms sampai 300ms tergantung panjang kata
                    const delay = Math.max(120, Math.min(300, word.length * 25));
                    
                    typingIntervals[elementId] = setTimeout(typeNextWord, delay);
                } else {
                    // Selesai mengetik, hapus cursor
                    cursor.remove();
                    
                    // Tandai slide sudah diketik
                    slideStates[slideIndex].typed = true;
                    
                    // Panggil callback jika ada
                    if (onComplete) onComplete();
                }
            }
            
            // Mulai mengetik dengan delay awal (DIPERLAMBAT)
            typingIntervals[elementId] = setTimeout(typeNextWord, 1000); // Diperlambat dari 500ms
        }
        
        // Handle slide change
        function handleSlideChange(slideIndex) {
            const currentSlideData = SLIDES[slideIndex];
            
            if (!currentSlideData) return;
            
            // Hentikan semua efek typing sebelumnya
            Object.values(typingIntervals).forEach(interval => clearInterval(interval));
            typingIntervals = {};
            
            switch(currentSlideData.type) {
                case 'message':
                    if (!slideStates[slideIndex]?.typed) {
                        // Mulai efek typing
                        typeText(`message-${slideIndex}`, currentSlideData.text, slideIndex, () => {
                            // Setelah selesai typing, update instruksi
                            const instructionEl = document.getElementById(`instruction-${slideIndex}`);
                            if (instructionEl) {
                                instructionEl.innerHTML = "‚úì Slide selesai! Gunakan tombol navigasi di bawah";
                                instructionEl.style.color = "#27ae60";
                                instructionEl.style.fontWeight = "bold";
                            }
                            
                            // Tandai slide sebagai selesai
                            completeSlide(slideIndex);
                            slideStates[slideIndex].autoComplete = true;
                            
                            // Untuk slide 2 (index 1), auto navigate setelah 3 detik (DIPERLAMBAT)
                            if (slideIndex === 1) {
                                setTimeout(() => {
                                    if (currentSlide === slideIndex) {
                                        swiper.slideNext();
                                    }
                                }, 4000); // Diperlambat dari 2000ms
                            }
                            // Untuk slide pesan lainnya, auto navigate setelah 5 detik (DIPERLAMBAT)
                            else if (slideIndex === 3) {
                                setTimeout(() => {
                                    if (currentSlide === slideIndex) {
                                        swiper.slideNext();
                                    }
                                }, 6000); // Diperlambat dari 3000ms
                            }
                        });
                    }
                    break;
                    
                case 'game':
                    if (!slideStates[2]?.completed) {
                        createGameBoard();
                    }
                    break;
                    
                case 'final':
                    if (!slideStates[slideIndex]?.typed) {
                        // Mulai efek typing untuk slide final
                        typeText(`message-${slideIndex}`, currentSlideData.text, slideIndex, () => {
                            // Setelah selesai typing, tandai sebagai completed
                            setTimeout(() => {
                                completeSlide(slideIndex);
                            }, 2000); // Delay 2 detik sebelum slide final selesai
                        });
                    }
                    break;
            }
        }
        
        // Game Functions
        function createGameBoard() {
            const gameBoard = document.getElementById('gameBoard');
            if (!gameBoard) return;
            
            gameBoard.innerHTML = '';
            gameCards = [];
            
            // Buat pasangan emoji
            let emojiPairs = [];
            GAME_EMOJIS.forEach(emoji => {
                emojiPairs.push(emoji, emoji);
            });
            
            // Acak emoji
            const shuffledEmojis = [...emojiPairs].sort(() => Math.random() - 0.5);
            
            shuffledEmojis.forEach((emoji, index) => {
                const card = document.createElement('div');
                card.className = 'card';
                card.dataset.emoji = emoji;
                card.dataset.index = index;
                
                const emojiSpan = document.createElement('span');
                emojiSpan.textContent = '?';
                
                card.appendChild(emojiSpan);
                card.addEventListener('click', () => flipCard(card));
                
                gameBoard.appendChild(card);
                gameCards.push(card);
            });
            
            matchedPairs = 0;
            updateGameStatus();
        }
        
        function flipCard(card) {
            if (!canFlip || card.classList.contains('flipped') || card.classList.contains('matched')) {
                return;
            }
            
            card.classList.add('flipped');
            card.querySelector('span').textContent = card.dataset.emoji;
            flippedCards.push(card);
            
            if (flippedCards.length === 2) {
                canFlip = false;
                checkForMatch();
            }
        }
        
        function checkForMatch() {
            const [card1, card2] = flippedCards;
            
            if (card1.dataset.emoji === card2.dataset.emoji) {
                card1.classList.add('matched');
                card2.classList.add('matched');
                matchedPairs++;
                
                updateGameStatus();
                
                if (matchedPairs === GAME_EMOJIS.length) {
                    const instructionEl = document.getElementById('gameInstruction');
                    if (instructionEl) {
                        instructionEl.textContent = "Game selesai! Gunakan tombol navigasi";
                    }
                    completeSlide(2);
                    slideStates[2].autoComplete = true;
                    
                    setTimeout(() => {
                        if (currentSlide === 2) {
                            swiper.slideNext();
                        }
                    }, 2500); // Diperlambat dari 1500ms
                }
                
                flippedCards = [];
                canFlip = true;
            } else {
                setTimeout(() => {
                    card1.classList.remove('flipped');
                    card2.classList.remove('flipped');
                    card1.querySelector('span').textContent = '?';
                    card2.querySelector('span').textContent = '?';
                    
                    flippedCards = [];
                    canFlip = true;
                }, 1500); // Diperlambat dari 1000ms
            }
        }
        
        function updateGameStatus() {
            const status = document.getElementById('gameStatus');
            if (status) {
                status.textContent = `Ditemukan: ${matchedPairs} dari ${GAME_EMOJIS.length} pasang`;
                
                if (matchedPairs === GAME_EMOJIS.length) {
                    status.innerHTML = '<span style="color:#e84393">üéâ Game Selesai! üéâ</span>';
                }
            }
        }
        
        function resetGame() {
            gameCards = [];
            flippedCards = [];
            createGameBoard();
        }
        
        // Fungsi mulai pengalaman (DIPERLAMBAT)
        async function mulaiPengalaman() {
            const startBtn = document.getElementById('startBtn');
            if (startBtn) {
                startBtn.disabled = true;
                startBtn.textContent = "Memulai...";
            }
            
            // Putar musik
            audio = document.getElementById('linkmp3');
            audio.volume = 0.5;
            audio.play().catch(e => console.log("Autoplay prevented:", e));
            audio.loop = true;
            
            // Tanya nama
            const { value: nama } = await Swal.fire({
                title: 'Halo! üëã',
                html: `<p style="font-size: 1.1rem; color: #2c3e50; margin-bottom: 15px; font-weight: 500;">
                      Sebelum kita mulai, boleh tahu nama panggilanmu?</p>`,
                input: 'text',
                inputPlaceholder: 'Masukkan nama panggilan...',
                showCancelButton: false,
                confirmButtonText: 'Lanjutkan',
                confirmButtonColor: CONFIG.colors.primary,
                width: '90%',
                background: '#fff',
                inputValidator: (value) => {
                    if (!value) return 'Tolong masukkan nama kamu...';
                }
            });
            
            namaGebetan = nama || CONFIG.defaultName;
            
            // Update greeting title
            const greetingTitle = document.getElementById('greetingTitle');
            if (greetingTitle) {
                greetingTitle.innerHTML = `Hai ${namaGebetan}! üëã`;
            }
            
            // Mark slide 0 as completed
            completeSlide(0);
            slideStates[0].autoComplete = true;
            
            // Auto navigate ke slide 2 setelah 1.5 detik (DIPERLAMBAT)
            setTimeout(() => {
                swiper.slideNext();
            }, 1500); // Diperlambat dari 1000ms
        }
    </script>
</body>
</html>